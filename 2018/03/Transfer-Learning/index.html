<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />

    

    
    <title>迁移学习 | 理想国</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="keywords" content="迁移学习,CNN,Caffe" />
    
    <meta name="description" content="&amp;emsp;&amp;emsp;作为一个苦逼的学生党，如果没有实验室或者公司支持，自己实践深度学习时经常会遇到一些困难：“自己网上搜集数据好麻烦，现成的数据集很多又都是要申请才能获得”；“破笔记本也太烂了，训练个两层CNN就要跑好几天，要达到满意的效果不知道要跑到猴年马月了”。在没有能力或者单纯不想从零开始训练模型时，迁移学习无疑是一大神器。我们可以从网上下载别人已经训练好的模型，将它们迁移到我们自己的任">
<meta property="og:type" content="article">
<meta property="og:title" content="迁移学习">
<meta property="og:url" content="https://haosutopia.github.io/2018/03/Transfer-Learning/">
<meta property="og:site_name" content="理想国">
<meta property="og:description" content="&amp;emsp;&amp;emsp;作为一个苦逼的学生党，如果没有实验室或者公司支持，自己实践深度学习时经常会遇到一些困难：“自己网上搜集数据好麻烦，现成的数据集很多又都是要申请才能获得”；“破笔记本也太烂了，训练个两层CNN就要跑好几天，要达到满意的效果不知道要跑到猴年马月了”。在没有能力或者单纯不想从零开始训练模型时，迁移学习无疑是一大神器。我们可以从网上下载别人已经训练好的模型，将它们迁移到我们自己的任">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://haosutopia.github.io/images/Transfer-Learning.jpeg">
<meta property="article:published_time" content="2018-03-03T15:57:18.000Z">
<meta property="article:modified_time" content="2019-03-18T21:49:52.000Z">
<meta property="article:author" content="进击的学渣">
<meta property="article:tag" content="迁移学习">
<meta property="article:tag" content="CNN">
<meta property="article:tag" content="Caffe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://haosutopia.github.io/images/Transfer-Learning.jpeg">
    

    
        <link rel="alternate" href="/" title="理想国" type="application/atom+xml" />
    

    
        <link rel="icon" href="/css/images/favicon.png" />
    

    
<link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">

    
<link rel="stylesheet" href="/libs/titillium-web/styles.css">

    
<link rel="stylesheet" href="/libs/source-code-pro/styles.css">


    
<link rel="stylesheet" href="/css/style.css">


    
<script src="/libs/jquery/3.5.0/jquery.min.js"></script>

    
    
        
<link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">

    
    
        
<link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">

    
    
        <script type="text/javascript">
(function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-115921256-1', 'auto');
ga('send', 'pageview');

</script>

    
    
        <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?fc799e8461d37896f29cc1ea74f75070";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

    
    


<meta name="generator" content="Hexo 5.2.0"></head>

<body>
    <div id="wrap">
        <header id="header">
    <div id="header-outer" class="outer">
        <div class="container">
            <div class="container-inner">
                <div id="header-title">
                    <h1 class="logo-wrap">
                        <a href="/" class="logo"></a>
                    </h1>
                    
                </div>
                <div id="header-inner" class="nav-container">
                    <a id="main-nav-toggle" class="nav-icon fa fa-bars"></a>
                    <div class="nav-container-inner">
                        <ul id="main-nav">
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/">主页</a>
                                </li>
                            
                                    <ul class="main-nav-list"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/%E6%8E%A7%E5%88%B6%E7%90%86%E8%AE%BA/">控制理论</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/%E6%8E%A7%E5%88%B6%E7%90%86%E8%AE%BA/%E5%88%86%E5%B8%83%E5%8F%82%E6%95%B0%E7%B3%BB%E7%BB%9F%E6%8E%A7%E5%88%B6/">分布参数系统控制</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/%E6%8E%A7%E5%88%B6%E7%90%86%E8%AE%BA/%E9%9D%9E%E7%BA%BF%E6%80%A7%E6%8E%A7%E5%88%B6/">非线性控制</a></li></ul></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">深度学习</a></li></ul></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89/">计算机视觉</a></li></ul>
                                
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/about/">关于</a>
                                </li>
                            
                        </ul>
                        <nav id="sub-nav">
                            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="搜索" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="想要查找什么..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>


</div>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>

        <div class="container">
            <div class="main-body container-inner">
                <div class="main-body-inner">
                    <section id="main">
                        <div class="main-body-header">
    <h1 class="header">
    
    <a class="page-title-link" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a><i class="icon fa fa-angle-right"></i><a class="page-title-link" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">深度学习</a>
    </h1>
</div>

                        <div class="main-body-content">
                            <article id="post-Transfer-Learning" class="article article-single article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
        迁移学习
        </h1>
    

            </header>
        
        
            <div class="article-meta">
                
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2018/03/Transfer-Learning/" class="article-date">
       <time datetime="2018-03-03T15:57:18.000Z" itemprop="datePublished">2018-03-03</time>
    </a>
  </div>


<div class="article-date">
  <i class="fa fa-calendar-plus-o"></i>
  <a href="/2018/03/Transfer-Learning/" class="article-date">
     <time datetime="2019-03-18T21:49:52.000Z" itemprop="dateModified">2019-03-18</time>
  </a>
</div>


                

                
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link-link" href="/tags/CNN/" rel="tag">CNN</a>, <a class="tag-link-link" href="/tags/Caffe/" rel="tag">Caffe</a>, <a class="tag-link-link" href="/tags/%E8%BF%81%E7%A7%BB%E5%AD%A6%E4%B9%A0/" rel="tag">迁移学习</a>
    </div>

                

                

            </div>
        
        
        <div class="article-entry" itemprop="articleBody">
            

            

            

            <p>&emsp;&emsp;作为一个苦逼的学生党，如果没有实验室或者公司支持，自己实践深度学习时经常会遇到一些困难：“自己网上搜集数据好麻烦，现成的数据集很多又都是要申请才能获得”；“破笔记本也太烂了，训练个两层CNN就要跑好几天，要达到满意的效果不知道要跑到猴年马月了”。在没有能力或者单纯不想从零开始训练模型时，迁移学习无疑是一大神器。我们可以从网上下载别人已经训练好的模型，将它们迁移到我们自己的任务中来。这些模型可能已经用了大量数据训练了很长时间了，因此使用它们可以大大提高我们的效率，并且能得到非常好的效果。本次学习材料主要是Deeplearning.ai课程以及当年本人毕设论文的部分内容，使用的是基于Matlab的Matcaffe框架，初步实现了人脸识别应用的One-shot learning。献丑了献丑了。</p>
<h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><p>&emsp;&emsp;迁移学习（Transfer Learning）顾名思义就是把已经训练好的模型迁移到新的任务中来使用。这里有一个前提就是新的任务和原来模型的目标任务有一定的相关性。比方说旧的模型是用来识别人脸的，就不能把它迁移去识别汽车，但可以用它来识别表情。但是这种所谓相关性是非常主观的，目前应该并没有一个严谨的理论来描述这种相关性，更多的是凭借直觉或者经验判断两者是否拥有一些共同特征。<br>&emsp;&emsp;通常根据我们拥有的训练数据多少以及新旧任务的相关性程度，可以对训练好的模型进行不同的操作。如果只有少量的训练数据并且新旧任务相关性较大的情况下，我们可以把训练好的模型当作一个特征提取器，通过它来提取数据特征，再进行进一步的训练。以CNN模型为例：<br><img src="/images/Transfer_Learning_CNN.PNG" alt="CNN Structure"><br>&emsp;&emsp;这是CNN的典型结构。输入图像$x$，经过一系列层最终得到输出$\hat{y}$，它代表了输入$x$属于各分类的概率。通常CNN最后一层为softmax层，我们可以将它删除，并根据自己的分类数量添加一个自定义softmax层。在使用数据训练时，我们将原模型的权重冻结，只训练我们自己定义的那层即可，这在很多深度学习框架中都能够实现。这种方式就相当于把数据通过模型提取出一系列特征，再将这些特征输入到我们定义的softmax层中用于分类。当然我们不止可以定义一层，也可以在原模型的基础上增加若干层。<br>&emsp;&emsp;如果我们有大量训练数据或者新旧任务相关性不是特别大的时候，可以只将（删除softmax层后）原模型的一部分层冻结，用训练数据训练剩余的层。或者干脆就将原模型权重作为现模型的初始值，训练整个模型。这些方式需要的训练数据量以及训练迭代次数依次增加。</p>
<h3 id="应用实践"><a href="#应用实践" class="headerlink" title="应用实践"></a>应用实践</h3><p>&emsp;&emsp;在这里使用迁移学习实现一个可交互的人脸识别应用，大致过程为：输入图像-&gt;检测图像中的人脸-&gt;剪裁人脸并缩放成标准大小-&gt;输入模型进行识别-&gt;若识别身份有误或者身份未在数据文件中，则人工修改身份-&gt;训练模型。其中人脸检测模型使用的是深圳先进技术研究所的MTCNN模型，人脸识别模型使用的是牛津大学的Visual Geometry Group的VGG-Face。由于条件有限，训练时仅训练自定义的softmax层。</p>
<h3 id="模型简介"><a href="#模型简介" class="headerlink" title="模型简介"></a>模型简介</h3><h4 id="MTCNN"><a href="#MTCNN" class="headerlink" title="MTCNN"></a>MTCNN</h4><p>&emsp;&emsp;<a target="_blank" rel="noopener" href="https://kpzhang93.github.io/MTCNN_face_detection_alignment/">MTCNN</a>由三个串联的CNN网络组成，它能够检测输入图片中的人脸，并将其眼睛、鼻子与嘴唇的几个关键位置找到并标记。其示意图如下：<br><img src="/images/Transfer_Learning_MTCNN.jpg" alt="MTCNN"><br>&emsp;&emsp;识别的步骤为：先将图片进行缩放，构造一个图像金字塔，再将它们输入到一个三级串联的网络中（P-Net，R-Net，O-Net），其中：<br><img src="/images/Transfer_Learning_P_Net.jpg" alt="P-Net结构示意"><br>&emsp;&emsp;<strong>Proposal Network(P-Net)**：该网络结构主要用来得到人脸区域的候选窗口和边界框的回归向量。再使用边界框的回归向量,对候选窗口进行校准,最后通过非极大值抑制(NMS:non-maximum suppression)来合并高度重叠的候选框。<br><img src="/images/Transfer_Learning_R_Net.jpg" alt="R-Net结构示意"><br>&emsp;&emsp;**Refine Network (R-Net)**：结构与 P-Net 类似,亦是通过边界框回归和NMS,在P-Net中输入的候选框来去掉一些不正确的候选框,从而获得更精确的选取边框。<br><img src="/images/Transfer_Learning_O_Net.jpg" alt="O-Net结构示意"><br>&emsp;&emsp;**Output Network（O-Net）</strong>：该层比R-Net层又多了一层卷积层，所以处理的结果会更加精细。其作用和R-Net一致，但是它对人脸区域进行了更多的监督，同时还会输出5个特征点。</p>
<h4 id="VGG-Face"><a href="#VGG-Face" class="headerlink" title="VGG-Face"></a>VGG-Face</h4><p>&emsp;&emsp;<a href="&emsp;&emsp;">VGG-Face</a>是一个通过260万张图片训练出来的CNN模型，具有很深的结构。它由1个输入层，13个卷积层，5个pooling层，2个全连接层和1个softmax层组成。其网络结构如下图所示：<br><img src="/images/Transfer_Learning_VGG_Face.png" alt="VGG-Face结构"><br>&emsp;&emsp;整个网络非常深，并且它仅用了比别人少得多的数据，却取得了更好的效果，在LFW（Labeled Faces In the Wild）与YFW（YouTube Faces Dataset）中均取得了当时世界顶级的成绩。</p>
<h3 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h3><p>&emsp;&emsp;应用实现时使用了Matlab的<a target="_blank" rel="noopener" href="https://cn.mathworks.com/products/matlab/app-designer.html">APP Designer</a>交互界面，因此部分代码会包含App Designer的部分函数，但这不是本文的重点。<br>&emsp;&emsp;Caffe的模型包含模型数据和模型框架两个文件，它们的后缀分别为<em>caffemodel</em>和<em>prototxt</em>。若要修改一个模型的网络结构，我们仅需在框架文件中修改层的定义即可。通常层的定义形式如下：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">layers &#123;</span><br><span class="line">  bottom: <span class="string">&quot;data&quot;</span>       <span class="comment">%输入为data</span></span><br><span class="line">  top: <span class="string">&quot;conv1&quot;</span>         <span class="comment">%输出为conv1</span></span><br><span class="line">  name: <span class="string">&quot;conv1&quot;</span>        <span class="comment">%层名字为conv1</span></span><br><span class="line">  <span class="built_in">type</span>: CONVOLUTION    <span class="comment">%层类型为卷积层</span></span><br><span class="line">  convolution_param &#123;  <span class="comment">%层参数定义</span></span><br><span class="line">    num_output: <span class="number">64</span>     <span class="comment">%filter数量为64</span></span><br><span class="line">    pad: <span class="number">1</span>             <span class="comment">%步长为1</span></span><br><span class="line">    kernel_size: <span class="number">3</span>     <span class="comment">%filter大小为3</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;在迁移学习中，我们要把VGG-Face的最后一层softmax去除，因此只需在VGG-Face框架文件中将最后一层的定义删除即可。在VGG-Face之后我们要加一层softmax层来预测自己的图像，由于本次应用中会有人员增加，softmax层的长度也会随之增加，因此在这里没有使用框架定义softmax层，而是直接在matlab中实现。并且通过自定义的数据格式，将每个人员的名字，特征以及对应softmax层的权重储存在一个cell数组中，并保存在名为<em>face_data.mat</em>文件中。cell数组结构示意如下：<br>$$<br>{W_i,\ b_i,\ {name_i},\ \begin{Bmatrix} feature_1 \ \vdots \ feature_n \end{Bmatrix}}$$<br>&emsp;&emsp;从左至右依次为第$i$个身份对应的权重、偏差、姓名以及储存的所有人脸特征。定义完这些后我们便可以开始写程序了。首先设置caffe的运行模式为cpu（当然你也可以选择gpu，但当时我的电脑显卡太烂，不支持CUDA）：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">caffe.set_mode_cpu(); <span class="comment">%设置运行模式</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;加载所需的模型：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">prototxt_dir =strcat(caffe_model_path,<span class="string">&#x27;/det1.prototxt&#x27;</span>);  <span class="comment">%设置框架文件路径</span></span><br><span class="line">model_dir = strcat(caffe_model_path,<span class="string">&#x27;/det1.caffemodel&#x27;</span>);  <span class="comment">%设置模型数据路径</span></span><br><span class="line">PNet=caffe.Net(prototxt_dir,model_dir,<span class="string">&#x27;test&#x27;</span>);            <span class="comment">%加载模型</span></span><br><span class="line">prototxt_dir = strcat(caffe_model_path,<span class="string">&#x27;/det2.prototxt&#x27;</span>);</span><br><span class="line">model_dir = strcat(caffe_model_path,<span class="string">&#x27;/det2.caffemodel&#x27;</span>);</span><br><span class="line">RNet=caffe.Net(prototxt_dir,model_dir,<span class="string">&#x27;test&#x27;</span>);</span><br><span class="line">prototxt_dir = strcat(caffe_model_path,<span class="string">&#x27;/det3.prototxt&#x27;</span>);</span><br><span class="line">model_dir = strcat(caffe_model_path,<span class="string">&#x27;/det3.caffemodel&#x27;</span>);</span><br><span class="line">ONet=caffe.Net(prototxt_dir,model_dir,<span class="string">&#x27;test&#x27;</span>);</span><br><span class="line">prototxt_dir =  strcat(caffe_model_path,<span class="string">&#x27;/det4.prototxt&#x27;</span>);</span><br><span class="line">model_dir =  strcat(caffe_model_path,<span class="string">&#x27;/det4.caffemodel&#x27;</span>);</span><br><span class="line">LNet=caffe.Net(prototxt_dir,model_dir,<span class="string">&#x27;test&#x27;</span>);</span><br><span class="line">prototxt_dir = strcat(caffe_model_path,<span class="string">&#x27;/VGG_FACE_deploy.prototxt&#x27;</span>);</span><br><span class="line">model_dir = strcat(caffe_model_path,<span class="string">&#x27;/VGG_FACE.caffemodel&#x27;</span>);</span><br><span class="line">Net=caffe.Net(prototxt_dir,model_dir,<span class="string">&#x27;test&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;其中<em>caffe_model_path</em>是放置模型文件的路径。模型加载完后需要读取图像并设置检测参数：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">img = imread([PathName FileName]]); <span class="comment">%读取图像</span></span><br><span class="line">im_size = <span class="built_in">size</span>(img(:,:,<span class="number">1</span>));         <span class="comment">%获取图像大小</span></span><br><span class="line">minsize=<span class="built_in">floor</span>(<span class="built_in">min</span>(im_size)/<span class="number">10</span>);     <span class="comment">%设置最小尺寸</span></span><br><span class="line">expand_rate = <span class="number">1.2</span>;                  <span class="comment">%设置扩展率</span></span><br><span class="line">imshow(img)                         <span class="comment">%显示图片</span></span><br><span class="line"><span class="built_in">hold</span> on                             <span class="comment">%hold住啊</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;其中最小尺寸指的是MTCNN最小检测尺寸，我们设置为图像最小边的十分之一。它表示若图像中存在很小的人脸（尺寸小于整个图像的十分之一），那么我们便忽略它。而设置扩展率是由于MTCNN截的边界框往往比人脸略小，我们希望输入VGG-Net的图像是完整的人脸，因此需要将边界框扩展一些。接下来将图像输入MTCNN中得到人脸的边界框，并进行适当的调整：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[box, ~]=detect_face(img,minsize,PNet,RNet,ONet,LNet,threshold,<span class="built_in">false</span>,<span class="built_in">factor</span>); <span class="comment">%检测人脸得到边界框</span></span><br><span class="line">boudingboxes=scale_box(box,expand_rate,im_size); <span class="comment">%调整边界框</span></span><br><span class="line">numbox=<span class="built_in">size</span>(boudingboxes,<span class="number">1</span>); <span class="comment">%边界框数目</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;其中<em>detect_face</em>函数是MTCNN官方定义的函数，它的输出是图像中人脸的边界框以及特征点。在这里我们不需要使用特征点，因此用～替代。<em>scale_box</em> 函数的作用是将变量box扩展并转换为可操作的数据结构。之后使用循环对每一个人脸进行裁剪，识别，并将它们的特征进行储存：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">featurelist = []; <span class="comment">%创建特征列表</span></span><br><span class="line">namelist = []; <span class="comment">%创建人名列表</span></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:numbox</span><br><span class="line">   rectangle(<span class="string">&#x27;Position&#x27;</span>,boudingboxes(<span class="built_in">i</span>,:),<span class="string">&#x27;Edgecolor&#x27;</span>,<span class="string">&#x27;g&#x27;</span>,<span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">3</span>); <span class="comment">%在图像上显示边界框</span></span><br><span class="line">   face = cut_face(img,boudingboxes(<span class="built_in">i</span>,:)); <span class="comment">%裁剪人脸</span></span><br><span class="line">   face = prepare_image(face); <span class="comment">%图像数据预处理</span></span><br><span class="line">   feature = Net.forward(&#123;face&#125;); <span class="comment">%输入到VGG-Face中得到人脸特征</span></span><br><span class="line">   [name,prob] = recognize_face(feature); <span class="comment">%通过自定义softmax层检测人脸</span></span><br><span class="line">   <span class="keyword">if</span> strcmp(name,<span class="string">&#x27;no data&#x27;</span>) <span class="comment">%若人脸被检测为未在数据文件中，则设置为&#x27;???&#x27;</span></span><br><span class="line">       name = <span class="string">&#x27;???&#x27;</span></span><br><span class="line">   <span class="keyword">end</span></span><br><span class="line">   text(double(boudingboxes(<span class="built_in">i</span>,<span class="number">1</span>)),double(boudingboxes(<span class="built_in">i</span>,<span class="number">2</span>))+<span class="number">10</span>,[num2str(<span class="built_in">i</span>) <span class="string">&#x27;. &#x27;</span> name],<span class="string">&#x27;Color&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,<span class="string">&#x27;FontSize&#x27;</span>,<span class="number">15</span>); <span class="comment">%将人名显示在图像中</span></span><br><span class="line">   featurelist = [featurelist feature&#123;<span class="number">1</span>,<span class="number">1</span>&#125;] <span class="comment">%将人脸特征加入特征列表，至于为什么是feature&#123;1,1&#125;可以参照输出定义</span></span><br><span class="line">   namelist = [namelist &#123;name&#125;]; <span class="comment">%将人名加入人名列表</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;这里要注意的是，由于在大家在训练模型的时候通常会对数据进行正规化（normalization），因此在使用模型时亦需要对输入数据进行相同处理，即预处理。这里使用的是<em>prepare_image</em>函数，其定义如下：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">img</span> = <span class="title">prepare_image</span><span class="params">(img)</span></span></span><br><span class="line">    img = single(img);</span><br><span class="line">    averageImage = [<span class="number">129.1863</span>,<span class="number">104.7624</span>,<span class="number">93.5940</span>]; <span class="comment">%VGG-Face模型正规化参数</span></span><br><span class="line">    img = <span class="built_in">cat</span>(<span class="number">3</span>,img(:,:,<span class="number">1</span>)-averageImage(<span class="number">1</span>),img(:,:,<span class="number">2</span>)-averageImage(<span class="number">2</span>),img(:,:,<span class="number">3</span>)-averageImage(<span class="number">3</span>));</span><br><span class="line"></span><br><span class="line">    img = img(:, :, [<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]); <span class="comment">% convert from RGB to BGR</span></span><br><span class="line">    img = <span class="built_in">permute</span>(img, [<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>]); <span class="comment">% permute width and height</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;利用自定义softmax层识别人脸所使用的是<em>recognize_face</em>函数。其定义如下：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[name,prob]</span> = <span class="title">recognize_face</span><span class="params">(feature)</span></span></span><br><span class="line">   load([data_path <span class="string">&#x27;/face_data.mat&#x27;</span>]); <span class="comment">%加载数据文件，data_path为文件所在路径</span></span><br><span class="line">   <span class="keyword">if</span> <span class="built_in">isempty</span>(face_data&#123;<span class="number">1</span>,<span class="number">3</span>&#125;) <span class="comment">%若身份数据为空，则输出&#x27;no data&#x27;</span></span><br><span class="line">       name=<span class="string">&#x27;no data&#x27;</span>;</span><br><span class="line">       prob=<span class="number">0</span>;</span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">       output = fc_forward(feature&#123;<span class="number">1</span>,<span class="number">1</span>&#125;,face_data); <span class="comment">%输入softmax层得到输出概率</span></span><br><span class="line">       [prob,num]=<span class="built_in">max</span>(output); <span class="comment">%得到概率最大相应概率及身份</span></span><br><span class="line">       <span class="keyword">if</span> prob &lt; <span class="number">0.6</span></span><br><span class="line">           name=<span class="string">&#x27;no data&#x27;</span>; <span class="comment">%若概率低于识别阈值0.6，则name等于‘no data’</span></span><br><span class="line">       <span class="keyword">else</span></span><br><span class="line">           name=face_data&#123;<span class="number">1</span>,<span class="number">3</span>&#125;&#123;num,<span class="number">1</span>&#125;; <span class="comment">%否则name等于身份</span></span><br><span class="line">       <span class="keyword">end</span></span><br><span class="line">   <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;以上便完成了输入图像并检测识别的过程。若需要修改身份并训练，则可以在交互界面修改，此时会更改namelist中相应的项。再使用新的身份列表和特征列表训练自定义softmax层。其实现代码如下：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="built_in">size</span>(namelist,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">if</span> n &gt; <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span> : n</span><br><span class="line">        <span class="keyword">if</span> ~strcmp(namelist&#123;<span class="number">1</span>,<span class="built_in">i</span>&#125;, <span class="string">&#x27;???&#x27;</span>)</span><br><span class="line">            face_add(namelist&#123;<span class="number">1</span>,<span class="built_in">i</span>&#125;,&#123;featurelist(:,<span class="built_in">i</span>)&#125;)</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    fc_train();</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;其中<em>face_add</em>函数将身份与对应特征加入数据文件中，其实现代码如下：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">face_add</span><span class="params">(name,feature)</span></span></span><br><span class="line">    load([data_path <span class="string">&#x27;\face_data.mat&#x27;</span>]); <span class="comment">%加载数据文件</span></span><br><span class="line">    [p,n]=<span class="built_in">ismember</span>(name,face_data&#123;<span class="number">1</span>,<span class="number">3</span>&#125;); <span class="comment">%判断身份是否在库内</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ~p(<span class="number">1</span>,<span class="number">1</span>) <span class="comment">%若人名未在库内</span></span><br><span class="line">        face_data&#123;<span class="number">1</span>,<span class="number">1</span>&#125;=[face_data&#123;<span class="number">1</span>,<span class="number">1</span>&#125;;(<span class="built_in">rand</span>(<span class="number">1</span>, <span class="number">4096</span>)<span class="number">-0.5</span>)*<span class="number">2</span>*<span class="built_in">sqrt</span>(<span class="number">6</span> / <span class="number">5000</span>)]; <span class="comment">%增加相应权重（weight）并初始化</span></span><br><span class="line">        face_data&#123;<span class="number">1</span>,<span class="number">2</span>&#125;=[face_data&#123;<span class="number">1</span>,<span class="number">2</span>&#125;;<span class="number">0</span>]; <span class="comment">%增加相应偏差（bias）并初始化</span></span><br><span class="line">        face_data&#123;<span class="number">1</span>,<span class="number">3</span>&#125;=[face_data&#123;<span class="number">1</span>,<span class="number">3</span>&#125;;&#123;name&#125;]; <span class="comment">%增加相应身份</span></span><br><span class="line">        face_data&#123;<span class="number">1</span>,<span class="number">4</span>&#125;=[face_data&#123;<span class="number">1</span>,<span class="number">4</span>&#125;;&#123;feature&#123;<span class="number">1</span>,<span class="number">1</span>&#125;&#x27;&#125;]; <span class="comment">%增加相应特征</span></span><br><span class="line">    <span class="keyword">else</span> <span class="comment">%否则</span></span><br><span class="line">        face_data&#123;<span class="number">1</span>,<span class="number">4</span>&#125;&#123;n,<span class="number">1</span>&#125;=[face_data&#123;<span class="number">1</span>,<span class="number">4</span>&#125;&#123;n,<span class="number">1</span>&#125;;feature&#123;<span class="number">1</span>,<span class="number">1</span>&#125;&#x27;]; <span class="comment">%增加相应身份的特征</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    save([data_path <span class="string">&#x27;\face_data.mat&#x27;</span>],<span class="string">&#x27;face_data&#x27;</span>); <span class="comment">%保存数据文件</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;训练自定义softmax层用的是<em>fc_train</em>函数，其实现代码如下：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fc_train</span><span class="params">()</span></span></span><br><span class="line">    load([data_path <span class="string">&#x27;/face_data.mat&#x27;</span>]); <span class="comment">%加载数据文件</span></span><br><span class="line">    iteration=<span class="number">800</span>; <span class="comment">%设置迭代次数</span></span><br><span class="line">    n=<span class="built_in">size</span>(face_data&#123;<span class="number">1</span>,<span class="number">1</span>&#125;,<span class="number">1</span>); <span class="comment">%得到身份总数</span></span><br><span class="line">    train_x=cell2mat(face_data&#123;<span class="number">1</span>,<span class="number">4</span>&#125;); <span class="comment">%得到特征，设为训练数据输入</span></span><br><span class="line">    train_x=train_x&#x27;;</span><br><span class="line">    train_y=[];</span><br><span class="line">    L=[];</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:n <span class="comment">%构造y的one-hot向量</span></span><br><span class="line">        temp_y=<span class="built_in">zeros</span>(n,<span class="built_in">size</span>(face_data&#123;<span class="number">1</span>,<span class="number">4</span>&#125;&#123;<span class="built_in">i</span>,<span class="number">1</span>&#125;,<span class="number">1</span>));</span><br><span class="line">        temp_y(<span class="built_in">i</span>,:)=<span class="number">1</span>;</span><br><span class="line">        train_y=[train_y temp_y];</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:iteration</span><br><span class="line">        output=fc_forward(train_x,face_data); <span class="comment">%前向传播得到输出</span></span><br><span class="line">        L=[L <span class="number">1</span>/<span class="number">2</span> * sum(sum((output-train_y) .^ <span class="number">2</span>)) / <span class="built_in">size</span>((output-train_y), <span class="number">2</span>)]; <span class="comment">%求出损失值</span></span><br><span class="line">        face_data=fc_backward(output,train_x,train_y,face_data); <span class="comment">%反向传播更新权重</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">mod</span>(<span class="built_in">i</span>,<span class="number">10</span>) == <span class="number">0</span></span><br><span class="line">            <span class="built_in">disp</span>([<span class="string">&#x27;process:&#x27;</span> num2str(<span class="built_in">i</span>) <span class="string">&#x27;/&#x27;</span> num2str(iteration)]); <span class="comment">%输出训练进度</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    clf;</span><br><span class="line">    <span class="built_in">plot</span>(L); <span class="comment">%画出损失函数曲线</span></span><br><span class="line">    save([data_path <span class="string">&#x27;/face_data.mat&#x27;</span>],<span class="string">&#x27;face_data&#x27;</span>); <span class="comment">%储存数据文件</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;更新数据文件其中前向传播与反向传播均自己定义，代码如下：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">output</span> = <span class="title">fc_forward</span><span class="params">(train_x,face_data)</span></span></span><br><span class="line">    output = sigm(face_data&#123;<span class="number">1</span>,<span class="number">1</span>&#125;*train_x+<span class="built_in">repmat</span>(face_data&#123;<span class="number">1</span>,<span class="number">2</span>&#125;,<span class="number">1</span>,<span class="built_in">size</span>(train_x,<span class="number">2</span>)));</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">face_data</span>=<span class="title">fc_backward</span><span class="params">(output,train_x,train_y,face_data)</span></span></span><br><span class="line">    l_rate=<span class="number">0.005</span>; <span class="comment">%设定学习率（learning rate）</span></span><br><span class="line">    reg=<span class="number">0.001</span>; <span class="comment">%设定正则化参数（regularization）</span></span><br><span class="line">    err=output-train_y; <span class="comment">%输出与真实值偏差</span></span><br><span class="line">    doutput=err .* (output .* (<span class="number">1</span> - output)); <span class="comment">%反向传播</span></span><br><span class="line">    dW=doutput * train_x&#x27; / <span class="built_in">size</span>(doutput, <span class="number">2</span>) + reg*face_data&#123;<span class="number">1</span>,<span class="number">1</span>&#125;;</span><br><span class="line">    db=<span class="built_in">mean</span>(doutput, <span class="number">2</span>);</span><br><span class="line">    face_data&#123;<span class="number">1</span>,<span class="number">1</span>&#125; = face_data&#123;<span class="number">1</span>,<span class="number">1</span>&#125; - l_rate * dW; <span class="comment">%更新权重</span></span><br><span class="line">    face_data&#123;<span class="number">1</span>,<span class="number">2</span>&#125; = face_data&#123;<span class="number">1</span>,<span class="number">2</span>&#125; - l_rate * db; <span class="comment">%更新偏差</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;更新数据文件后我们便能用新的权重来识别了。</p>
<h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><p>&emsp;&emsp;整个交互界面如下图所示：<br><img src="%5Cimages%5CTransfer_Learning_Interface.jpg" alt="交互界面"><br>&emsp;&emsp;Open Image按钮选择并显示图像；Recognize按钮识别并将识别的身份显示在右侧列表内；Change按钮更改列表中人名；Save按钮训练并保存数据文件；DataClear按钮清除数据文件。测试时我们先清楚数据文件，之后使用一张图片作为训练数据对网络最后一层进行训练。训练图片如下：<br><img src="%5Cimages%5CTransfer_Learning_Training_Data.jpg" alt="训练图片"><br>&emsp;&emsp;训练完毕后使用另一张测试图片识别：<br><img src="%5Cimages%5CTransfer_Learning_Test_Data.jpg" alt="测试图片"><br>&emsp;&emsp;使用摄像头识别：</p>
<figure class="half">
    <img src="\images\Transfer_Learning_Video_1.jpg">
    <img src="\images\Transfer_Learning_Video_2.jpg">
</figure>
&emsp;&emsp;效果还不错啦。
### 不足与改进
&emsp;&emsp;可以说这是我深度学习第一个应用的项目，当时并不知道迁移学习的概念，只是单纯发现自己电脑跑不动深度网络，无奈之下采取了这种方式。整个项目还是有很多不足的地方，比如之前在设计识别阈值时候纠结了半天，并且效果还不好。而其实softmax的输出并不能完全当作概率来看，每次增加新身份后它的输出值都会相应下降。正确的做法是在已有身份之外再设置一个"unknown"身份，若输出向量中"unknown"数值最大则视为人脸未识别。
&emsp;&emsp;另外就是交互功能不完善，纯粹是为了交互而交互。不过当初设计也就是为了好玩，是肯定不能应用到实际中的。
### 小结
1. 迁移学习是将已经训练好的网络迁移到新任务中使用的方法，可以大大提高开发效率。
2. 迁移学习需要新旧任务有关联性。
3. 迁移学习应用举例。

        </div>
        <footer class="article-footer">
            



    <a data-url="https://haosutopia.github.io/2018/03/Transfer-Learning/" data-id="ckflt9wo1002jeto9hsvcemk1" class="article-share-link"><i class="fa fa-share"></i>分享到</a>
<script>
    (function ($) {
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

        </footer>
    </div>
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        "author": {
            "@type": "Person",
            "name": "进击的学渣"
        },
        "headline": "迁移学习",
        "image": "https://haosutopia.github.io/images/Transfer-Learning.jpeg",
        "keywords": "迁移学习 CNN Caffe",
        "genre": "机器学习 深度学习",
        "datePublished": "2018-03-03",
        "dateCreated": "2018-03-03",
        "dateModified": "2019-03-18",
        "url": "https://haosutopia.github.io/2018/03/Transfer-Learning/",
        "description": "&emsp;&emsp;作为一个苦逼的学生党，如果没有实验室或者公司支持，自己实践深度学习时经常会遇到一些困难：“自己网上搜集数据好麻烦，现成的数据集很多又都是要申请才能获得”；“破笔记本也太烂了，训练个两层CNN就要跑好几天，要达到满意的效果不知道要跑到猴年马月了”。在没有能力或者单纯不想从零开始训练模型时，迁移学习无疑是一大神器。我们可以从网上下载别人已经训练好的模型，将它们迁移到我们自己的任",
        "wordCount": 1576
    }
</script>

</article>

    <section id="comments">
    
        
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>


    
    </section>



                        </div>
                    </section>
                    <aside id="sidebar">
    <a class="sidebar-toggle" title="Expand Sidebar"><i class="toggle icon"></i></a>
    <div class="sidebar-top">
        <p>关注我 :</p>
        <ul class="social-links">
            
                
                <li>
                    <a class="social-tooltip" title="twitter" href="/" target="_blank" rel="noopener">
                        <i class="icon fa fa-twitter"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="facebook" href="https://www.facebook.com/people/%E7%8E%8B%E8%AF%9A%E7%9A%93/100004082464920" target="_blank" rel="noopener">
                        <i class="icon fa fa-facebook"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="instagram" href="https://www.instagram.com/changhao_wang0809/" target="_blank" rel="noopener">
                        <i class="icon fa fa-instagram"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="github" href="https://github.com/HaosUtopia" target="_blank" rel="noopener">
                        <i class="icon fa fa-github"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="weibo" href="/" target="_blank" rel="noopener">
                        <i class="icon fa fa-weibo"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="rss" href="/" target="_blank" rel="noopener">
                        <i class="icon fa fa-rss"></i>
                    </a>
                </li>
                
            
        </ul>
    </div>
    
        
<nav id="article-nav">
    
        <a href="/2018/03/RSVP-03/" id="article-nav-newer" class="article-nav-link-wrap">
        <strong class="article-nav-caption">下一篇</strong>
        <p class="article-nav-title">
        
            分布参数系统控制（三）：求解模型
        
        </p>
        <i class="icon fa fa-chevron-right" id="icon-chevron-right"></i>
    </a>
    
    
        <a href="/2018/03/RSVP-02/" id="article-nav-older" class="article-nav-link-wrap">
        <strong class="article-nav-caption">上一篇</strong>
        <p class="article-nav-title">分布参数系统控制（二）：建立模型</p>
        <i class="icon fa fa-chevron-left" id="icon-chevron-left"></i>
        </a>
    
</nav>

    
    <div class="widgets-container">
        
            
                
    <div class="widget-wrap">
        <h3 class="widget-title">最新文章</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/08/Computer-Vision-01/" class="thumbnail">
    
    
        <span style="background-image:url(/images/Computer_Vision.jpg)" alt="计算机视觉（一）：图像表示与梯度" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89/">计算机视觉</a></p>
                            <p class="item-title"><a href="/2018/08/Computer-Vision-01/" class="title">计算机视觉（一）：图像表示与梯度</a></p>
                            <p class="item-date"><time datetime="2018-08-08T19:13:45.000Z" itemprop="datePublished">2018-08-08</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/05/Decision-Tree-01/" class="thumbnail">
    
    
        <span style="background-image:url(/images/Decision_Tree.png)" alt="决策树" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a></p>
                            <p class="item-title"><a href="/2018/05/Decision-Tree-01/" class="title">决策树</a></p>
                            <p class="item-date"><time datetime="2018-05-31T20:56:03.000Z" itemprop="datePublished">2018-05-31</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/04/K-Means-01/" class="thumbnail">
    
    
        <span style="background-image:url(/images/K_Means.png)" alt="K-Means聚类算法" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a></p>
                            <p class="item-title"><a href="/2018/04/K-Means-01/" class="title">K-Means聚类算法</a></p>
                            <p class="item-date"><time datetime="2018-04-15T13:27:06.000Z" itemprop="datePublished">2018-04-15</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/04/RSVP-07/" class="thumbnail">
    
    
        <span style="background-image:url(/images/RSVP.png)" alt="分布参数系统控制（七）：边界输入" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/%E6%8E%A7%E5%88%B6%E7%90%86%E8%AE%BA/">控制理论</a><i class="icon fa fa-angle-right"></i><a class="article-category-link" href="/categories/%E6%8E%A7%E5%88%B6%E7%90%86%E8%AE%BA/%E5%88%86%E5%B8%83%E5%8F%82%E6%95%B0%E7%B3%BB%E7%BB%9F%E6%8E%A7%E5%88%B6/">分布参数系统控制</a></p>
                            <p class="item-title"><a href="/2018/04/RSVP-07/" class="title">分布参数系统控制（七）：边界输入</a></p>
                            <p class="item-date"><time datetime="2018-04-12T22:39:55.000Z" itemprop="datePublished">2018-04-13</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/04/RSVP-06/" class="thumbnail">
    
    
        <span style="background-image:url(/images/RSVP.png)" alt="分布参数系统控制（六）：反馈控制" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/%E6%8E%A7%E5%88%B6%E7%90%86%E8%AE%BA/">控制理论</a><i class="icon fa fa-angle-right"></i><a class="article-category-link" href="/categories/%E6%8E%A7%E5%88%B6%E7%90%86%E8%AE%BA/%E5%88%86%E5%B8%83%E5%8F%82%E6%95%B0%E7%B3%BB%E7%BB%9F%E6%8E%A7%E5%88%B6/">分布参数系统控制</a></p>
                            <p class="item-title"><a href="/2018/04/RSVP-06/" class="title">分布参数系统控制（六）：反馈控制</a></p>
                            <p class="item-date"><time datetime="2018-04-10T22:19:02.000Z" itemprop="datePublished">2018-04-11</time></p>
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>

            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">分类</h3>
        <div class="widget">
            <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%8E%A7%E5%88%B6%E7%90%86%E8%AE%BA/">控制理论</a><span class="category-list-count">8</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%8E%A7%E5%88%B6%E7%90%86%E8%AE%BA/%E5%88%86%E5%B8%83%E5%8F%82%E6%95%B0%E7%B3%BB%E7%BB%9F%E6%8E%A7%E5%88%B6/">分布参数系统控制</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%8E%A7%E5%88%B6%E7%90%86%E8%AE%BA/%E9%9D%9E%E7%BA%BF%E6%80%A7%E6%8E%A7%E5%88%B6/">非线性控制</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a><span class="category-list-count">10</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">深度学习</a><span class="category-list-count">3</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89/">计算机视觉</a><span class="category-list-count">1</span></li></ul>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">归档</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">四月 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">一月 2018</a><span class="archive-list-count">4</span></li></ul>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">标签</h3>
        <div class="widget">
            <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Backstepping/" rel="tag">Backstepping</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CNN/" rel="tag">CNN</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Caffe/" rel="tag">Caffe</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/" rel="tag">Python</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SVM/" rel="tag">SVM</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tensorflow/" rel="tag">Tensorflow</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%88%86%E5%B8%83%E5%8F%82%E6%95%B0%E7%B3%BB%E7%BB%9F/" rel="tag">分布参数系统</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1/" rel="tag">数学建模</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%97%A0%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0/" rel="tag">无监督学习</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E5%AD%90%E7%90%86%E8%AE%BA/" rel="tag">算子理论</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BF%81%E7%A7%BB%E5%AD%A6%E4%B9%A0/" rel="tag">迁移学习</a><span class="tag-list-count">1</span></li></ul>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-float">
        <h3 class="widget-title">标签云</h3>
        <div class="widget tagcloud">
            <a href="/tags/Backstepping/" style="font-size: 13.33px;">Backstepping</a> <a href="/tags/CNN/" style="font-size: 10px;">CNN</a> <a href="/tags/Caffe/" style="font-size: 10px;">Caffe</a> <a href="/tags/Python/" style="font-size: 10px;">Python</a> <a href="/tags/SVM/" style="font-size: 16.67px;">SVM</a> <a href="/tags/Tensorflow/" style="font-size: 13.33px;">Tensorflow</a> <a href="/tags/%E5%88%86%E5%B8%83%E5%8F%82%E6%95%B0%E7%B3%BB%E7%BB%9F/" style="font-size: 20px;">分布参数系统</a> <a href="/tags/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1/" style="font-size: 10px;">数学建模</a> <a href="/tags/%E6%97%A0%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0/" style="font-size: 10px;">无监督学习</a> <a href="/tags/%E7%AE%97%E5%AD%90%E7%90%86%E8%AE%BA/" style="font-size: 10px;">算子理论</a> <a href="/tags/%E8%BF%81%E7%A7%BB%E5%AD%A6%E4%B9%A0/" style="font-size: 10px;">迁移学习</a>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">链接</h3>
        <div class="widget">
            <ul>
                
                    <li>
                        <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a>
                    </li>
                
                    <li>
                        <a target="_blank" rel="noopener" href="https://www.tensorflow.org/">TensorFlow</a>
                    </li>
                
            </ul>
        </div>
    </div>


            
        
    </div>
</aside>

                </div>
            </div>
        </div>
        <footer id="footer">
    <div class="container">
        <div class="container-inner">
            <a id="back-to-top" href="javascript:;"><i class="icon fa fa-angle-up"></i></a>
            <div class="credit">
                <h1 class="logo-wrap">
                    <a href="/" class="logo"></a>
                </h1>
                <p>&copy; 2020 进击的学渣</p>
                
            </div>
            <div class="footer-plugins">
              
    


            </div>
        </div>
    </div>
</footer>

    </div>
    
    
    <script>
    var disqus_shortname = 'jin-ji-de-xue-zha';
    
    
    var disqus_url = 'https://haosutopia.github.io/2018/03/Transfer-Learning/';
    
    (function() {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>





    
        
<script src="/libs/lightgallery/js/lightgallery.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-pager.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-zoom.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-hash.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-share.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-video.min.js"></script>

    
    
        
<script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>

    
    
        <script type="text/x-mathjax-config">
            MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
        </script>
        
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML.js"></script>

    

    



<!-- Custom Scripts -->

<script src="/js/main.js"></script>


</body>
</html>
